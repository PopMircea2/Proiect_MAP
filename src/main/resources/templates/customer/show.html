<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Customer Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div class="container mt-5">
    <a th:href="@{/customers}" class="btn btn-outline-secondary mb-3">Back to list</a>
    <div class="card shadow-sm">
        <div class="card-body">
            <h4 class="card-title">Customer <span th:text="${customer.name}"></span></h4>
            <p><strong>Date of birth:</strong> <span th:text="${customer.dateBirth}"></span></p>
            <div>
                <strong>Tickets:</strong>
                <span th:if="${customer.tickets == null || #lists.isEmpty(customer.tickets)}">None</span>
                <ul th:if="${customer.tickets != null && !#lists.isEmpty(customer.tickets)}">
                    <li th:each="t : ${customer.tickets}" th:text="${t.screening != null ? t.screening.movie.title + ' - ' + t.screening.date : t.screening}"></li>
                </ul>
            </div>
            <div class="mt-3">
                <a th:href="@{/customers/{id}/edit(id=${customer.id})}" class="btn btn-primary me-2">Edit</a>
                <button id="deleteBtn" class="btn btn-danger">Delete</button>
                <script th:inline="javascript">
                /*<![CDATA[*/
                (function(){
                    var id = /*[[${customer.id}]]*/ '0';
                    document.getElementById('deleteBtn').addEventListener('click', function(){
                        fetch('/customers/' + id + '/delete', {method: 'POST'}).then(function(){ window.location.href = '/customers'; });
                    });
                })();
                /*]]>*/
                </script>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
